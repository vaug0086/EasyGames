@model EasyGames.Models.Order
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<h1>Order #@Model.Id</h1>

<div class="mb-3">
    <a class="btn btn-light" asp-action="Index" asp-route-shopId="@Model.ShopId">← Back to orders</a>
</div>

<div class="row g-3">
    <div class="col-md-6">
        <div class="card p-3 h-100">
            <h5>Summary</h5>
            <dl class="row mb-0">
                <dt class="col-sm-5">Date</dt>
                <dd class="col-sm-7">@Model.CreatedUtc.ToLocalTime().ToString("f")</dd>

                <dt class="col-sm-5">Status</dt>
                <dd class="col-sm-7">@Model.Status</dd>

                <dt class="col-sm-5">Channel</dt>
                <dd class="col-sm-7">@Model.Channel</dd>

                <dt class="col-sm-5">Shop</dt>
                <dd class="col-sm-7">@Model.ShopId</dd>
            </dl>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card p-3 h-100">
            <h5>Customer</h5>
            <p class="mb-0">
                @if (!string.IsNullOrWhiteSpace(Model.User?.FullName))
                {
                    <strong>@Model.User.FullName</strong>
                
                    <br />
                }
                <span>@Model.User?.Email</span><br />
                <span>@Model.User?.PhoneNumber</span>
            </p>
        </div>
    </div>
</div>

<div class="card p-3 mt-3">
    <h5 class="mb-2">Items</h5>
    <div class="table-responsive">
        <table class="table align-middle">
            <thead>
                <tr>
                    <th>Item</th>
                    <th class="text-end">Qty</th>
                    <th class="text-end">Unit</th>
                    <th class="text-end">Line</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var it in Model.Items)
                {
                    <tr>
                        <td>@it.StockItem?.Name</td>
                        <td class="text-end">@it.Quantity</td>
                        <td class="text-end">@it.UnitPriceAtPurchase.ToString("C")</td>
                        <td class="text-end">@((it.UnitPriceAtPurchase * it.Quantity).ToString("C"))</td>
                    </tr>
                }
            </tbody>
            <tfoot>
                <tr>
                    <th colspan="3" class="text-end">Subtotal</th>
                    <th class="text-end">@Model.Subtotal.ToString("C")</th>
                </tr>
                <tr>
                    <th colspan="3" class="text-end">Grand Total</th>
                    <th class="text-end">@Model.GrandTotal.ToString("C")</th>
                </tr>
                <tr>
                    <th colspan="3" class="text-end text-muted">Total Cost</th>
                    <th class="text-end text-muted">@Model.TotalCost.ToString("C")</th>
                </tr>
                <tr>
                    <th colspan="3" class="text-end text-muted">Profit</th>
                    <th class="text-end text-muted">@Model.TotalProfit.ToString("C")</th>
                </tr>
            </tfoot>
        </table>
    </div>
</div>
