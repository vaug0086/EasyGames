@model EasyGames.Models.Emailing.EmailCampaign
@{
    ViewData["Title"] = "Edit Campaign";
    var groups = (IEnumerable<EasyGames.Models.Emailing.CustomerGroup>)ViewBag.Groups ?? [];
}
<h1>Edit Campaign</h1>

<form asp-action="Edit" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" name="id" value="@Model.Id" />

    <div class="mb-3">
        <label class="form-label">Name</label>
        <input name="name" class="form-control" value="@Model.Name" required />
    </div>

    <div class="mb-3">
        <label class="form-label">Subject</label>
        <input name="subject" class="form-control" value="@Model.Subject" required />
    </div>

    <div class="mb-3">
        <label class="form-label">Group</label>
        <select name="groupId" class="form-select" required>
            @foreach (var g in groups)
            {
                <option value="@g.Id" selected="@(g.Id == Model.GroupId)">
                    @g.Name (@(g.Members?.Count ?? 0))
                </option>
            }
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Details</label>
        <textarea name="details" class="form-control" rows="8" required>@Model.Details</textarea>
    </div>

    @* Given this assignment is not hosted and with blob storage, and is only for development at this stage,
       image upload has not been made functional. Instead the user must provide links to existing publicly
       available images. Long term this would be transitioned to a hosted blob storage like S3. *@
    <div class="mb-3">
        <label class="form-label">Image URL (optional)</label>
        <input name="imageUrl" class="form-control" value="@Model.ImageUrl" placeholder="https://example.com/banner.jpg" />
        <div class="form-text">Provide a URL to a publicly accessible image. File upload is not currently supported. Must be an absolute http/https URL.</div>
    </div>

    @if (!string.IsNullOrWhiteSpace(Model.ImageUrl))
    {
        <div class="mb-3">
            <label class="form-label d-block">Current Image</label>
            <img src="@Model.ImageUrl" alt="" class="img-fluid rounded border" style="max-height:160px" />
            <div class="form-check mt-2">
                <input class="form-check-input" type="checkbox" name="clearImage" id="clearImage">
                <label class="form-check-label" for="clearImage">Clear image</label>
            </div>
        </div>
    }

    <div class="mt-3">
        <button class="btn btn-primary">Save changes</button>
        <a asp-action="Details" asp-route-id="@Model.Id" class="btn btn-secondary ms-2">Cancel</a>
    </div>
</form>
